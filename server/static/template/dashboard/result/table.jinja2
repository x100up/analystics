{% set showTime = interval in ['minute', 'hour', '10minutes'] %}

<h1>Сводная таблица </h1>
<div id="tableBox">
{% for key in tablesdata %}
    {% set tabledata = tablesdata[key] %}
    <table class="data_table">
        <thead>
            <tr>
                <th id="emptyData">_</th>
                <th class="r m" onclick="selectColumn(this, 'sum')"><span>Сумма <span class="button sort down" onclick="sortResultTable(event, this, 'sum')"></span></span></th>
                <th class="r m" onclick="selectColumn(this, 'avg')"><span>Среднее <span class="button sort down"  onclick="sortResultTable(event, this, 'avg')"></span></span></th>
                {% for ts in tabledata['columnHeaders'] %}
                <th onclick="selectColumn(this, {{ loop.index0 }})" data-timestamp="{{ ts }}" class="date m">
                    <span>{{ ts|excelDate(data['interval']) }}</span>
                    {% if showTime %}
                     <em> {{ ts|excelTime(data['interval']) }}</em>
                    {% endif %}
                </th>
                {% endfor %}
            </tr>
        </thead>

        <tbody>
            {% for rowData in tabledata['rowsData'] %}
                <tr class="datarow" data-sum="{{ rowData.sum }}" data-avg="{{ rowData.avg }}" data-index="{{ loop.index }}">
                    <th onclick="selectRow(this)" data-seriesindex="{{ rowData.seriesIndex }}" data-chartindex="{{ rowData.chartIndex }}">
                        <span>{{ rowData.header }}</span>
                        <em>
                        {{ rowData.tagHeader }}
                        </em>
                    </th>
                    <td class="value r col_sum">{{ rowData.sum|numberFormat }}</td>
                    <td class="value r col_avg">{{ rowData.avg|numberFormat }}</td>
                    {% for value in rowData['values'] %}
                        <td class="value col_{{ loop.index0 }}">{{ value|numberFormat }}</td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endfor %}

</div>

<div id="tableMenu">
    <button onclick="copyToBuffer()">выделить выбранное</button>
    <button onclick="exportToExcel()">экспортировать в эксель</button>
    <button onclick="createChartWithSelectedData()">построить график</button>
</div>